---
layout: post
title: "Коварный символ ‘/’ в custom формате даты"
date: 2010-08-30 08:36:23
categories: ru
tags: [.NET, C#, DateTime, Custom Format, CultureInfo]
permalink: ru/blog/show/233
---
<p>Вопрос, какую директорию создаст этот код?</p>  <div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; color: black; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">   <div style="padding-left: 0px; padding-right: 0px; padding-top: 0px; adding-bottom: 0px" id="codeSnippet">     <pre style="background-color: white; margin: 0em"><span style="color: #0000ff">string</span> sole = DateTime.Today.ToString(<span style="color: #006080">&quot;yyyy/MM/dd&quot;</span>);</pre>
<!--CRLF-->

    <pre style="margin: 0em"><span style="color: #0000ff">string</span> path = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, sole);</pre>
<!--CRLF-->

    <pre style="background-color: white; margin: 0em"><span style="color: #0000ff">if</span> (!Directory.Exists(path))</pre>
<!--CRLF-->

    <pre style="margin: 0em">    Directory.CreateDirectory(path);</pre>
<!--CRLF--></div>
</div>



<p>Вчера для меня было шоком, что, вроде, логично ожидать директорию вроде “…/2010/08/29”,&#160; а я получил “…/2010.08.29”. Запускаем этот код:</p>

<div style="border-bottom: silver 1px solid; text-align: left; border-left: silver 1px solid; padding-bottom: 4px; line-height: 12pt; background-color: #f4f4f4; margin: 20px 0px 10px; padding-left: 4px; width: 97.5%; padding-right: 4px; font-family: &#39;Courier New&#39;, courier, monospace; direction: ltr; color: black; overflow: auto; border-top: silver 1px solid; cursor: text; border-right: silver 1px solid; padding-top: 4px" id="codeSnippetWrapper">
  <div style="padding-left: 0px; padding-right: 0px; padding-top: 0px; adding-bottom: 0px" id="codeSnippet">
    <pre style="background-color: white; margin: 0em">CultureInfo[] cultureInfos = CultureInfo.GetCultures(CultureTypes.AllCultures);</pre>
<!--CRLF-->

    <pre style="margin: 0em">&#160;</pre>
<!--CRLF-->

    <pre style="background-color: white; margin: 0em"><span style="color: #0000ff">foreach</span> (var cultureInfo <span style="color: #0000ff">in</span> cultureInfos)</pre>
<!--CRLF-->

    <pre style="margin: 0em">{</pre>
<!--CRLF-->

    <pre style="background-color: white; margin: 0em">    Thread.CurrentThread.CurrentCulture = cultureInfo;</pre>
<!--CRLF-->

    <pre style="margin: 0em">    Thread.CurrentThread.CurrentUICulture = cultureInfo;</pre>
<!--CRLF-->

    <pre style="background-color: white; margin: 0em">&#160;</pre>
<!--CRLF-->

    <pre style="margin: 0em">    <span style="color: #0000ff">string</span> sole = DateTime.Today.ToString(<span style="color: #006080">&quot;yyyy/MM/dd&quot;</span>);</pre>
<!--CRLF-->

    <pre style="background-color: white; margin: 0em">    <span style="color: #0000ff">string</span> path = Path.Combine(AppDomain.CurrentDomain.BaseDirectory, sole);</pre>
<!--CRLF-->

    <pre style="margin: 0em">&#160;</pre>
<!--CRLF-->

    <pre style="background-color: white; margin: 0em">    Console.WriteLine(path);</pre>
<!--CRLF-->

    <pre style="margin: 0em">}</pre>
<!--CRLF-->

    <pre style="background-color: white; margin: 0em">&#160;</pre>
<!--CRLF-->

    <pre style="margin: 0em">Console.ReadKey();</pre>
<!--CRLF--></div>
</div>

<p>И смотрим:</p>

<p><img style="background-image: none; border-right-width: 0px; padding-left: 0px; padding-right: 0px; display: inline; border-top-width: 0px; border-bottom-width: 0px; border-left-width: 0px; padding-top: 0px" title="Console" border="0" alt="Console" src="/Library/2010/08/30/Console_45A330DF.png" width="677" height="438" /></p>

<p>В общем,&#160; раньше не встречался с этой фичей, а оказывается - это <a href="http://msdn.microsoft.com/en-us/library/8kb3ddd4.aspx#dateSeparator">специальный символ</a> в custom формате, который подставляется на значение из <a href="http://msdn.microsoft.com/en-us/library/system.globalization.datetimeformatinfo.dateseparator.aspx">DateTimeFormatInfo.DateSeparator</a> (такой же есть и для времени). Как хорошо, что у нас разделитель точка, а вот другие страны <a href="/en/blog/show/201#comment_719">мучаются и не понимают</a>, почему их формат “dd/MM/yyyy” не работает, во время я осознал проблему и <a href="/en/blog/show/201#comment_723">подсказал</a> об этой фиче.</p>

<p>Все мелочи не запомнишь, и многое просто проскальзывает, .NET расширяется с каждым годом, и даже базовые вещи уже не все помнишь. Вы, кстати, знали об этой фиче? Были ли подобные неожиданные встречи?</p>
