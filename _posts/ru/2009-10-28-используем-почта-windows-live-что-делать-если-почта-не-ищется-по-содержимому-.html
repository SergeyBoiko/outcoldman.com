---
layout: post
title: "Используем Почта Windows Live. Что делать, если почта не ищется по содержимому?"
date: 2009-10-28 08:47:00
categories: ru
tags: [Windows 7, IFilter TIFF, Windows Live, Windows Live Mail, Windows Search]
alias: ru/blog/show/164
---
<p><img title="overview" border="0" alt="overview" align="left" width="410" height="309" style="border-bottom: 0px; border-left: 0px; display: inline; margin-left: 0px; border-top: 0px; margin-right: 0px; border-right: 0px" src="/library/images/01/0000064.jpeg" /> После того, как я перешел на <strong>Windows 7</strong> возникла проблема, что мне стал необходим почтовый клиент. Хотелось использовать что то уж очень простое, как в ранних версиях Windows вроде Vista или XP встроенный почтовый клиент <strong>Почта Windows</strong>. Но, как оказалось, встроенный средств нет, самый простой для меня выход был это использование <a href="http://download.live.com">Windows Live Essentials</a>, в которые входят и Почта, и Рисунки, и Writer (которым я пользуюсь для написания топиков). Так вот, поставить почту оказалось очень просто, письма можно с легкостью импортировать из других клиентов, если форматы поддерживаются.</p><p>Следующий шаг &ndash; это настройка правил для сообщений. Когда приходит много почты, и потом хочется удалить лишнюю или найти какую то почту в определенной папке, то грамотно распределенные письма по папкам &ndash; это залог успеха. Потому жмем F10, чтобы появилось основное меню приложения (в случае если оно у вас не отображается), идем в <em>Сервис -&gt; Правила для сообщений &ndash;&gt; Почта&hellip; </em>и там начинаем создавать правила. Еще один вариант это создавать правило из сообщения &ndash; это когда вы находитесь на каком то сообщении и в меню (F10) выбираете <em>Действия &ndash;&gt; Создать правило из сообщения&hellip;</em>, в этом случае у вас сразу будет подставлено в шаблоне <em>от кого</em>.</p><p>Так вот, на самом деле этот топик я хотел написать не об этом. Хоть мои письма и находятся в отличном отсортированной иерархичной структуре папок, но все равно иногда приходится поискать какое-то письмо по определенным словам. И вот что я заметил, <a href="http://windows.microsoft.com/ru-RU/windows7/products/features/windows-search">Windows Search</a> ищет у меня письма только по заголовкам, по адресатам, но никак не по самому содержимому. Причем я точно помнил, что в Vista у меня все отлично искалось всегда. Первая мысль &ndash; ну вот и ограниченность бесплатной версии, и с этой мыслью я жил около месяца. Потом все таки в голову пришла мысль, что, вообще, за поиск отвечает отдельная служба в Windows 7, в которой регистрируются необходимые папки для поиска и типы файлов, по которым нужно искать. Чтобы открыть окно настройки поиска в строке <em>Search Programs and Files&hellip; </em>(при нажатии на WinKey) набираем <strong><em>Indexing Options</em></strong> и выбираем этот пункт. Откроется достаточно скудное окно, которое а) может позволить посмотреть какие папки у вас сейчас зарегистрированы для индексирования по содержимому б) посмотреть какие типы файлов будут индексироваться и как (по содержимому или только по свойствам файла). Так вот для типа файлов <strong>.eml</strong> я посмотрел настройки (<em>Advanced-&gt;File Types</em>) &ndash; выбрано и по содержимому и по свойствам. После небольших поисков в интернете я нашел подобные описанные проблемы и нашел один путь решения его <a href="http://www.sevenforums.com/general-discussion/1785-search-not-able-index-contents-windows-live-mail.html">здесь</a>.</p><p>Как оказалось проблеме подвержены машины с установленной 64-битной Windows 7. По каким то причинам для типов файлов .eml не верно указан iFilter (это небольшое приложение, которое умеет определенный файл преобразовывать в текст для последующего индексирования). Вот что нужно сделать для исправления:</p><p>1. Открываем <strong>RegEdit</strong>&nbsp;<em>(WinKey + R и там набираем regedit и нажимаем Enter)</em>. <br />2. Переходим по пути <strong>HKEY_CLASSES_ROOT\.eml\PersistentHandler</strong> и устанавливаем Default Value <strong>{5645C8C1-E277-11CF-8FDA-00AA00A14F93}</strong> <em>(У меня было установлено {0563DB41-F538-4B37-A92D-4659049B7766}). <br /></em>3. Опять открываем окно <strong>Indexing Options</strong> идем в <strong>Advanced</strong> и там жмем Rebuild (процесс долгий, все зависит от того сколько у вас будет индексироваться файлов, но процесс будет работать в background, и после того как все проиндексируется &ndash; должен заработать поиск по содержимому писем, по крайней мере у меня заработало на двух компьютерах).</p><p>И мало кто знает, что дополнительно в Windows 7 можно <a href="http://technet.microsoft.com/ru-ru/library/dd744687(WS.10).aspx">установить</a> <a href="http://technet.microsoft.com/ru-ru/library/dd755985(WS.10).aspx">TIFF iFilter</a>, он нужен для индексирования и оптического распознавания символов (optical character recognition OCR) изображении TIFF (such as LZW, JPG, CCITT v4, CCITT v6, and uncompressed).</p><p>Рекомендую к прочтению статью <a href="http://blogs.msdn.com/e7ru/archive/2008/11/07/9049342.aspx"><strong>И еще раз к вопросу о поиске</strong></a>.</p>
